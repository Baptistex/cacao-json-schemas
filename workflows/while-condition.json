{
    "$id": "https://raw.githubusercontent.com/fovea-research/cacao-json-schema/security-playbooks-v1.0-cs02/schemas/workflows/while-condition.json",
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "title": "while-condition",
    "description": "This section defines the 'while' conditionallogic that can be used within the workflow of the playbook. In addition to theinherited properties, this section defines three additional specific propertiesthat are valid for this type.",
    "type": "object",
    "allOf": [
        {
            "$ref": "https://raw.githubusercontent.com/fovea-research/cacao-json-schema/security-playbooks-v1.0-cs02/schemas/workflows/workflow-step-common.json"
        },
        {
            "properties": {
                "type": {
                    "type": "string",
                    "description": "The value of this property MUST be while-condition.",
                    "enum": [
                        "while-condition"
                    ]
                },
                "condition": {
                    "type": "string",
                    "description": "A boolean expression as defined in the STIX Patterning Grammar that while it is true executes the workflow step identified by on_do otherwise it exits the while conditional workflow step and executes the on_end workflow step"
                },
                "on_true": {
                    "type": "array",
                    "items": {
                        "$ref": "https://raw.githubusercontent.com/fovea-research/cacao-json-schema/security-playbooks-v1.0-cs02/schemas/data-types/identifier.json"
                    },
                    "minItems": 1,
                    "description": "The list of sequential step IDs to be processed every time the loop condition evaluates as true. Each ID MUST represent either a CACAO workflow step object or a CACAO playbook object."
                },
                "on_false": {
                    "$ref": "https://raw.githubusercontent.com/fovea-research/cacao-json-schema/security-playbooks-v1.0-cs02/schemas/data-types/identifier.json",
                    "description": "The ID of the next step to be processed every time the loop condition evaluates as false. The ID MUST represent either a CACAO workflow step object or a CACAO playbook object."
                }
            },
            "required": [
                "type",
                "condition",
                "on_true",
                "on_false"
            ]
        }
    ],
    "unevaluatedProperties": false
}