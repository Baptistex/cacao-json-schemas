{
  "$id": "command.json",
  "$schema": "https://json-schema.org/draft/2019-09/schema",
  "title": "Command",
  "description": "",
  "type": "object",
  "allOf": [
    {
      "properties": {
        "type": {
          "type": "string",
          "enum": [
            "manual",
            "http-api",
            "ssh",
            "bash",
            "openc2-json",
            "attack-cmd",
            "sigma",
            "jupyter",
            "kestrel"
          ],
          "description": "The type of command being used. The value of this property SHOULD come from the command-type-ov vocabulary."
        },
        "command": {
          "type": "string",
          "description": "A string-based command as defined by the type. Commands can be simple strings or stringified JSON based on the defined type.  The command MUST be valid for the defined type and version."
        },
        "command_b64": {
          "type": "string",
          "contentEncoding": "base64",
          "description": "A base64 encoded (see section 4 of [RFC 4648]) command as defined by the type. This property is used for structured commands that are not simple strings or native JSON.  The command MUST be valid for the defined type and version."
        },
        "version": {
          "type": "string",
          "description": "An optional version of the command language being used. If no version is specified then the most current version of the command language SHOULD be used."
        }
      }
    }
  ],
  "required": [
    "type"
  ],
  "$defs": {
    "command-type-ov": {
      "type": "string",
      "enum": [
        "manual",
        "http-api",
        "ssh",
        "bash",
        "openc2-json",
        "attack-cmd",
        "sigma",
        "jupyter",
        "kestrel"
      ]
    }
  },
  "unevaluatedProperties": false
}