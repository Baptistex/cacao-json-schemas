{
    "$id": "https://raw.githubusercontent.com/fovea-research/cacao-json-schema/security-playbooks-v1.0-cs02/schemas/workflows/single.json",
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "title": "single",
    "description": "This workflow step contains the actualcommands to be executed on one or more targets. These commands are intended tobe processed sequentially one at a time. In addition to the inheritedproperties, this section defines five more specific properties that are validfor this type.",
    "type": "object",
    "allOf": [
        {
            "$ref": "https://raw.githubusercontent.com/fovea-research/cacao-json-schema/security-playbooks-v1.0-cs02/schemas/workflows/workflow-step-common.json"
        },
        {
            "properties": {
                "type": {
                    "type": "string",
                    "description": "The value of this property MUST be single.",
                    "enum": [
                        "single"
                    ]
                },
                "commands": {
                    "type": "array",
                    "items": {
                        "$ref": "https://raw.githubusercontent.com/fovea-research/cacao-json-schema/security-playbooks-v1.0-cs02/schemas/commands/command.json"
                    },
                    "minItems": 1,
                    "description": "A list of commands that are to be executed as part of this step. If more than one command is listed, the commands MUST be processed in the order in which they are listed."
                },
                "target": {
                    "$ref": "https://raw.githubusercontent.com/fovea-research/cacao-json-schema/security-playbooks-v1.0-cs02/schemas/targets/target.json",
                    "description": "A target that SHOULD execute the commands defined in this step. The value of this property MUST contain a CACAO target object (see section 6). If this property is defined the target_ids property MUST NOT be defined."
                },
                "target_ids": {
                    "type": "array",
                    "items": {
                        "$ref": "https://raw.githubusercontent.com/fovea-research/cacao-json-schema/security-playbooks-v1.0-cs02/schemas/data-types/identifier.json"
                    },
                    "minItems": 1,
                    "description": "A list of target ID references that SHOULD execute the commands defined in this step. Each ID MUST reference a CACAO target object. If this property is defined the target property MUST NOT be defined."
                },
                "in_args": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "minItems": 1,
                    "description": "The optional list of arguments passed to the target(s) as input to the step"
                },
                "out_args": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    },
                    "minItems": 1,
                    "description": "The optional list of arguments that are returned from this step after execution of the commands by the targets"
                }
            },
            "required": [
                "type",
                "commands"
            ]
        }
    ],
    "unevaluatedProperties": false
}